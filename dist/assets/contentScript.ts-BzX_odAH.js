(function(){let J=0,p=!1,y=null,w=!1;function g(t){return((t==null?void 0:t.innerText)||(t==null?void 0:t.textContent)||"").trim()}function h(t,e){const o=(t||"").toLowerCase();return e.some(n=>o.includes(n))}function L(t){var n,a,s,i;if(!t)return"";const e=(t.tagName||"").toUpperCase();if((((a=(n=t.type)==null?void 0:n.toLowerCase)==null?void 0:a.call(n))||"")==="checkbox")return t.checked?"Yes":"No";if(e==="SELECT"){const r=t;return((i=(s=r.options)==null?void 0:s[r.selectedIndex])==null?void 0:i.text)||r.value||""}return t.value||""}function E(t){return t.id?t.id:t.action?t.action.split("/").pop()||"unknown":`form_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function _(t){try{const e=E(t),o=new FormData(t),n={};for(const[s,i]of o.entries())n[s]=i;const a={formId:e,timestamp:Date.now(),data:n};localStorage.setItem(`jt_form_${e}`,JSON.stringify(a)),p=!0}catch(e){console.warn("Job Tracker: Failed to save form data:",e)}}function x(t){try{const e=E(t),o=localStorage.getItem(`jt_form_${e}`);if(o){const n=JSON.parse(o),{data:a}=n;Object.entries(a).forEach(([s,i])=>{const r=t.querySelector(`[name="${s}"]`);r&&(r.type==="checkbox"?r.checked=i==="Yes"||i===!0:(r.tagName,r.value=i))}),p=!0,console.log("Job Tracker: Form data restored from localStorage")}}catch(e){console.warn("Job Tracker: Failed to restore form data:",e)}}function U(t){try{const e=E(t);localStorage.removeItem(`jt_form_${e}`),p=!1}catch(e){console.warn("Job Tracker: Failed to clear form data:",e)}}function I(t){y&&clearInterval(y),y=setInterval(()=>{p&&!w&&_(t)},3e3)}function q(){y&&(clearInterval(y),y=null)}function j(t){const e=t.querySelector('button[type="submit"], input[type="submit"]');if(e){e.disabled=!0;const o=e.value||e.textContent||"Submit";e.setAttribute("data-original-text",o),e.value=e.textContent="Submitting...",e.tagName==="BUTTON"&&(e.innerHTML='<span class="loading-spinner">‚è≥</span> Submitting...')}}function V(t){const e=t.querySelector('button[type="submit"], input[type="submit"]');if(e){e.disabled=!1;const o=e.getAttribute("data-original-text")||"Submit";e.value=e.textContent=o,e.tagName==="BUTTON"&&(e.innerHTML=o)}}function F(t){if(p&&!w)return t.preventDefault(),t.returnValue="You have unsaved changes. Are you sure you want to leave?","You have unsaved changes. Are you sure you want to leave?"}function D(t){const e=t.target;e&&e.form&&(p=!0,_(e.form))}function v(t,e){const o=t?Array.from(t.querySelectorAll("label")):[];for(const n of o){const a=g(n).toLowerCase();if(a&&e.some(s=>a.includes(s))){const s=n.getAttribute("for");if(s){const d=t.querySelector(`#${CSS.escape(s)}`),c=L(d);if(c)return c.trim()}const i=n.querySelector("input,select,textarea"),r=L(i);if(r)return r.trim()}}return""}function S(t,e){const o=Array.from((t==null?void 0:t.querySelectorAll("input,select,textarea"))||[]);for(const n of o){const a=(n.getAttribute("name")||"").toLowerCase(),s=(n.id||"").toLowerCase(),i=(n.getAttribute("aria-label")||"").toLowerCase(),r=(n.getAttribute("placeholder")||"").toLowerCase(),d=`${a} ${s} ${i} ${r}`;if(e.some(c=>d.includes(c))){const c=L(n);if(c)return c.trim()}}return""}function P(t){var o;const e=Array.from((t==null?void 0:t.querySelectorAll('input[type="file"]'))||[]);for(const n of e){const a=n;if(a.files&&a.files.length>0)return((o=a.files[0])==null?void 0:o.name)||"";if(a.value){const s=a.value.split(/[\\/]/);return s[s.length-1]||""}}return""}function H(){var d,c;const t=document.querySelector('meta[property="og:title"], meta[name="title"]'),e=(t==null?void 0:t.getAttribute("content"))||document.title||"";let o="";const n=document.querySelector('meta[property="og:site_name"], meta[name="author"], meta[property="article:author"]');if(n&&(o=g(n)),!o){const l=['header [class*="logo"]','header [class*="brand"]','header [class*="company"]','nav [class*="logo"]','nav [class*="brand"]',".logo",".brand",'[data-test*="logo"]','[data-test*="brand"]','[class*="header"] [class*="company"]','[class*="navbar"] [class*="company"]'];for(const f of l){const m=document.querySelector(f);if(m){const b=g(m);if(b&&b.length>0&&b.length<50){o=b;break}}}}if(!o){const l=document.querySelector('[data-company-name], [class*="company" i], [class*="employer" i]');o=g(l||void 0)}if(!o){const l=window.location.hostname;if(l&&!l.includes("localhost")&&!l.includes("127.0.0.1")){const f=l.split(".");if(f.length>=2){const m=f[f.length-2];m&&m.length>2&&(o=m.charAt(0).toUpperCase()+m.slice(1))}}}const a=document.querySelector('[class*="location" i], [data-test*="location" i]'),s=g(a||void 0),i=((c=(d=document.body)==null?void 0:d.innerText)==null?void 0:c.toLowerCase())||"";let r="";return i.includes("remote")?r="Remote":i.includes("hybrid")?r="Hybrid":(i.includes("on-site")||i.includes("onsite")||i.includes("on site"))&&(r="On-site"),{title:e,company:o,location:s,workMode:r}}function C(t){var k;const e=(location.href||"").toLowerCase(),n=["greenhouse","lever.co","boards.greenhouse.io","workday","myworkdayjobs","ashbyhq","ashby","smartrecruiters","workable","icims","bamboohr","jobs.lever","workforcenow","jobvite","recruitee","lever","greenhouse.io"].some(u=>e.includes(u))||h(e,["job","jobs","careers","apply"]),a=t||document,s=Array.from(a.querySelectorAll("input,select,textarea")),i=s.some(u=>(u.getAttribute("type")||"").toLowerCase()==="password");if(i)return!1;const r=(((k=document.body)==null?void 0:k.innerText)||"").toLowerCase(),d=h(r,["apply","job","position","role","employment","experience","resume","cv","cover letter"]),c=s.some(u=>(u.getAttribute("type")||"").toLowerCase()==="file"),l=s.some(u=>{const A=(u.getAttribute("name")||"").toLowerCase(),N=(u.id||"").toLowerCase(),O=(u.getAttribute("aria-label")||"").toLowerCase(),$=(u.getAttribute("placeholder")||"").toLowerCase(),B=`${A} ${N} ${O} ${$}`;return h(B,["cover","cover letter"])}),m=Array.from(a.querySelectorAll('button,input[type="submit"], [role="button"]')).some(u=>h((u.innerText||u.value||u.textContent||"").trim().toLowerCase(),["apply","submit application","send application","apply now","submit"])),M=s.filter(u=>{const A=(u.getAttribute("type")||"").toLowerCase();return["hidden","button","submit","reset"].indexOf(A)===-1}).length>=3||c||l;return[n,d,c,l,m,M].filter(Boolean).length>=2&&!i}function K(t){const e=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),n=t.getFullYear();return`${e}/${o}/${n}`}function R(t){const e=K(new Date),o=location.href,n=["company","organisation","organization","employer","org"],a=["location","city","state","country"],s=["title","position","role","job title"],i=["remote","hybrid","on-site","onsite","on site","work type","work mode"],r=t||document,d={company:v(r,n),location:v(r,a),title:v(r,s),workMode:v(r,i)},c={company:d.company||S(r,n),location:d.location||S(r,a),title:d.title||S(r,s),workMode:d.workMode||S(r,i)},l=H(),f=P(r);return{company:c.company||l.company||"",location:c.location||l.location||"",title:c.title||l.title||"",workMode:c.workMode||l.workMode||"",applicationDate:e,url:o,resume:f}}async function Y(t){try{return await chrome.runtime.sendMessage({type:"JOB_APPLICATION_SUBMITTED",payload:t})}catch(e){return{ok:!1,error:String((e==null?void 0:e.message)||e)}}}function T(t){if(Date.now()-J<8e3)return;const o=t.target instanceof HTMLFormElement?t.target:null;if(!o||!C(o))return;if(w){t.preventDefault();return}if(t.type!=="submit")return;w=!0,j(o),q();const n=R(o);setTimeout(async()=>{try{const a=await Y(n);a!=null&&a.ok&&(U(o),p=!1,console.log("Job Tracker: Form submitted successfully, data cleared"))}catch(a){console.warn("Job Tracker: Submission failed:",a)}finally{w=!1,V(o)}},10)}function z(t){const e=t.target;if(!e)return;const o=(e.innerText||e.textContent||"").trim();if(o&&h(o,["apply","submit","send application","apply now","submit application"])){if(e.closest("form")&&(e.type==="submit"||e.getAttribute("type")==="submit"))return;console.log("Job Tracker: Apply button clicked, but waiting for actual form submission");return}}function G(){window.addEventListener("beforeunload",F),document.addEventListener("input",D,!0),document.addEventListener("change",D,!0),document.querySelectorAll("form").forEach(o=>{C(o)&&(x(o),I(o),o.addEventListener("submit",T,!0))}),new MutationObserver(o=>{o.forEach(n=>{n.addedNodes.forEach(a=>{a.nodeType===Node.ELEMENT_NODE&&a.querySelectorAll("form").forEach(r=>{C(r)&&(x(r),I(r),r.addEventListener("submit",T,!0))})})})}).observe(document.body,{childList:!0,subtree:!0})}function Q(){G(),document.addEventListener("submit",T,!0),document.addEventListener("click",z,!0)}window.addEventListener("unload",()=>{q(),window.removeEventListener("beforeunload",F)});Q();
//# sourceMappingURL=contentScript.ts-BzX_odAH.js.map
})()
